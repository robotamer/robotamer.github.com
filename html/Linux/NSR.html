<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd>
<html xmlns="http://www.w3.org/1999/xhtml">
    <head>
		    <title>RoboTamer - Coding and Linux</title>
		    <meta name="description" content="Go Programming Language" />
    <meta name="copyright" content="Copyright 1998 - 2012" />
    <meta name="rating" content="General" />
    <meta name="author" content="Dennis T Kaplan" />
    <meta name="robots" content="index" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta http-equiv="Window-Target" content="_top" />
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <meta http-equiv="Content-Language" content="en-US" />
		    <link rel="stylesheet" href="/assets/css/robotamer.css" type="text/css" media="screen" />
    </head>
    <body>
		<header>
	<p>
		<a href="http://www.robotamer.com/html" title="RoboTamer">Lobby</a>
		<a href="http://www.robotamer.com/index.html" title="Blog">News</a>
		<a href="http://www.robotamer.com/forum.html" title="Forum">Forum</a>
		<a href="http://www.robotamer.com/html/Linux" title="Linux">Linux</a>
		<a href="http://www.robotamer.com/html/GoTamer" title="GoTamer">GoTamer</a>
		<a href="http://www.robotamer.com/html/PHPTamer" title="PHP Tamer">PHPTamer</a>
		<a href="http://www.robotamer.com/html/md2static" title="Markdown to Static">md2static</a>
	</p>
		</header>

        <content>
            <div style="padding-right: 25em">
				<h1>Network Safety Restart Bash Script</h1>

<p>If you ever work on a remote server/computer specialty on the network settings then this script may safe you from having to call support, and waiting on them.</p>

<p>When started/executed it</p>

<ul>
<li>Sleeps first for 1 hour</li>
<li>Then it renames the ”/etc/network/interfaces” file by adding the current time stamp to the end of the file</li>
<li>It renames a file called ”/etc/network/interfaces.org” to ”/etc/network/interfaces”</li>
<li>And finally it restarts the server.</li>
</ul>

<p>It also warns you a couple minutes before it does all that so you can terminate the program. Of course if you have been locked out you can't terminate it, and it will execute. Giving you a fresh start!</p>

<p>To start</p>

<pre><code>network_Safety_Restart.sh start &amp;
</code></pre>

<p>To Stop</p>

<pre><code>network_Safety_Restart.sh stop
</code></pre>

<p>network<em>Safety</em>Restart.sh</p>

<pre><code>#! /bin/sh

PATH=/sbin:/usr/sbin:/bin:/usr/bin

. /lib/lsb/init-functions

export PIDFILESTART=/tmp/network-safty-restart-start.pid
export PIDFILESTOP=/tmp/network-safty-restart-stop.pid
export FILE=/etc/network/interfaces

case "$1" in
  start)  
    if [ -f ${PIDFILESTART} ]; then
            rm ${PIDFILESTART}
    fi
    if [ -f ${PIDFILESTOP} ]; then
            rm ${PIDFILESTOP}
    fi  
    ps -fe | grep ${1} | head -n1 | cut -d" " -f 6 &gt; ${PIDFILESTART}

        sleep 3600 

        log_action_msg "WARNING: Will in 120 sec rename ${FILE} and then restart"
        sleep 60
        log_action_msg "WARNING: Will in 60 sec rename ${FILE} and then restart"
        sleep 60

    if ! [ -f ${PIDFILESTOP} ]; then
        log_action_msg "Restarting NOW"
            SUFFIX=$(date +%s)
            cp ${FILE} ${FILE}.${SUFFIX}
            sleep 1
            cp ${FILE}.org ${FILE}
            sleep 1
            reboot -d -f -i
    else
        rm ${PIDFILESTOP}
        log_action_msg "NOT Restaring as you wish"
        fi
        ;;
  stop)
    if [ -f ${PIDFILESTART} ]; then
            rm ${PIDFILESTART}
        touch ${PIDFILESTOP}
        log_action_msg "Terminating restart script"

    fi
    log_action_msg "Terminated restart script"

    exit 0
        ;;
  *)
        echo "Usage: $0 start|stop" &gt;&amp;2
        exit 3
        ;;
esac
</code></pre>

<!-- START: Livefyre Embed -->
<script type='text/javascript' src='http://zor.livefyre.com/wjs/v1.0/javascripts/livefyre_init.js'></script>
<script type='text/javascript'>
    var fyre = LF({
        site_id: 312331
    });
</script>
<!-- END: Livefyre Embed -->


            </div>
            <sidebar>
				<div style="text-align: center; ">
                    <img width="90" height="110" border="0" src="/assets/img/robotamer.gif"/>
                    <hr />
                </div>
			
			
				Last modified: 2012-09-21<hr /><a href="http://www.robotamer.com/html/Linux/Bridge-Utils.html" title="Bridge-Utils">Bridge-Utils</a><br /><a href="http://www.robotamer.com/html/Linux/Git.html" title="Git">Git</a><br /><a href="http://www.robotamer.com/html/Linux/HowTo-Mail-Server-Fingerprint.html" title="HowTo-Mail-Server-Fingerprint">HowTo-Mail-Server-Fingerprint</a><br /><a href="http://www.robotamer.com/html/Linux/LXC.html" title="LXC">LXC</a><br /><a href="http://www.robotamer.com/html/Linux/Msmtp.html" title="Msmtp">Msmtp</a><br /><a href="http://www.robotamer.com/html/Linux/NSR.html" title="NSR">NSR</a><br /><a href="http://www.robotamer.com/html/Linux/Sendmail.html" title="Sendmail">Sendmail</a><br /><a href="http://www.robotamer.com/html/Linux/Snippets.html" title="Snippets">Snippets</a><br /><a href="http://www.robotamer.com/html/Linux/Ssh.html" title="Ssh">Ssh</a><br />			<footer><hr />Copyright &copy; 2012 RoboTamer</footer>
			<hr />
			<script language="JavaScript1.1" src="http://bdv.bidvertiser.com/BidVertiser.dbm?pid=22279&bid=1216050" type="text/javascript"></script>
            </sidebar>
        </content>
		<script type="text/javascript">
    var infolink_pid = 1110019;
    var infolink_wsid = 0;
</script>
<script type="text/javascript" src="http://resources.infolinks.com/js/infolinks_main.js"></script>
		<script type="text/javascript">
		  var _gaq = _gaq || [];
		  _gaq.push(['_setAccount', 'UA-27513756-1']);
		  _gaq.push(['_setDomainName', 'robotamer.com']);
		  _gaq.push(['_trackPageview']);

		  (function() {
		    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
		    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
		    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
		  })();
		</script>
    </body>
</html>
